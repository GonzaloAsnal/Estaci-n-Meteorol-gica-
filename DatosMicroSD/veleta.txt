<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESTACIÓN METEOROLÓGICA</title>
    <link rel="icon" href="images/utn.png">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @font-face {
            font-family: 'MiFuente';
            src: url('/tipografia/Utendo-ExtraBold.ttf') format('truetype');
        }

        *{
            font-family: 'MiFuente';
            margin: 0;
            padding: 0;
            user-select: none
        }

        body{
            background-color: #71d0ff70;
            background-image: url("../images/fondos/soleado.jpg");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        #titulo{
        	margin-bottom: 1vh;
    	padding-top: 2vh;
    	font-size: 7vh;
    	text-align: center;
    	text-shadow: 2px 2px 4px rgba(255, 255, 255, 1);
    	-webkit-text-stroke: 0.1px rgb(255, 255, 255);
        }

        #centrador {
            display: flex;
            justify-content: center;
            height: 80%;
            width: 100%;
        }

        .centradorgr{
            height: 95%;
            width: 95%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .contenedor{
            height: 100%;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr 3fr;
        }

        .parametro{
            text-align: center;
            margin-top: 1vh;
            width: 95vw;
            height: 82vh;
            background: white;
            border-radius: 2vh;
            box-shadow: 3px 3px 3px 1px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .parametro h2{
            padding: 1%;
            font-size: 2vw;
        }

        footer{
            font-size: 2.5vh;
            margin-top: 1vh;
            padding-left: 2vh;
            text-align: center;
        }

        .volver{
            position: absolute;
            margin: 1vh;
            border-radius: 2vh;
            height: 7vh;
            width: 7vh;
            background-image: url("https://imagizer.imageshack.com/v2/547x456q70/r/924/njCeSL.png");
            background-repeat: no-repeat;
            background-size: 100%;
            background-position: center center;
        }

        .containerVeleta {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            height: 90%;
            width: 100%;
            text-align: center;
        }

        .velocimetroVeleta{
            background-image: url("https://imageshack.com/a/img924/7354/x52O1C.png");
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            justify-content: center;
            align-items: center;    
            width: 90%;
            height: 100%;
        }

        .speedometerVeleta{
            display: flex;
            justify-content: center;
            align-items: center;
            height: 1%;
            width: 1%;
            transform: translateY(-1800%);
        }

        #agujaVeleta{
            height: 3500%;
            transform-origin: bottom center;
        }

        #Veleta p {
            text-align: center;
            font-size: 5vh;
        }

        #acomodar{
            text-align: center;
            width: 100%;
            height: 40vh;
        }

        #contornos{
            display: grid;
            grid-template-columns: 1fr 3fr;
            height: 90%;
        }

        .valor{
            margin-top: 12vh;
            font-size: 4vw;
            color: rgb(88, 88, 88);
            width:100%;
        }

        .valor span{
            color: black;
        }

        .grafico{
            background: rgba(0, 0, 0, 0.2);
            border-radius: 2vh;
            height: 100%;
            width: 100%;
        }
        #chartContainer{
            display: flex;
            justify-content: center;
            align-items: center;
            height: 90%;
            width: 100%;
        }

        #myChart{
            height: 100%;
            width: 100%;
        }

        @media (max-width: 430px) {
            #centrador {
                display: flex;
                justify-content: center;
                height: 100%;
                width: 100%;
            }

            /* Estilos específicos para pantallas más pequeñas */
            #titulo{
                font-size: 4vh;
            }

            .parametro h2{
                padding: 1%;
                font-size: 8vw;
            }

            #contornos{
                display: grid;
                grid-template-columns: 1fr;
                grid-template-rows: 1fr 2fr;
                row-gap: 5vh;
                width: 99%;
                height: 100%;
            }

            .parametro{
                text-align: center;
                width: 95%;
                height: auto;
                background: white;
            }

            footer{
                font-size: 2.5vh;
                margin-top: 2vh;
            }

            .valor{
                font-size: 6vw;
                color: rgb(88, 88, 88);
            }

            .centradorgr{
                height: 100%;
                width: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .grafico{
                background: rgba(0, 0, 0, 0.2);
                border-radius: 2vh;
                height: 85%;
                width: 90%;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1 id="titulo">ESTACIÓN METEOROLÓGICA</h1>
    </header>
    <div id="centrador">
        <div class="parametro">
            <div style="position: absolute;">
                <a href="index.html" >
                    <div class="volver"></div>
                </a>
            </div>
            
            <h2>Veleta</h2>
            
            <div id="contornos">
                <div id="acomodar">
                    <div class="containerVeleta">
                        <div class="velocimetroVeleta">
                            <div class="speedometerVeleta">
                                <img src="https://imagizer.imageshack.com/v2/336x468q70/r/923/8a3v89.png" alt="" id="agujaVeleta">
                            </div>
                        </div>
                        
                        <p class="valor"><span id="valorVeleta">!!Veleta!!</span></p>
                    </div>
                </div>
            
                <div class="centradorgr">
                    <div class="grafico">
                        <select name="hs" id="hs" onchange="actualizarGrafico()">
	           <option value="1h">1 Hora</option>
                            <option value="1d" selected>24 Horas</option>
                            <option value="7d">7 Días</option>
                            <option value="1m">1 Mes</option>
                            <option value="1a">1 Año</option>
                        </select>
                        <div id="chartContainer">
                            <canvas id="myChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>
            Todos los derechos reservados® - UTN FRVM - Ingeniería Electrónica 2023
        </p>
    </footer>
    <script >
    
        valorPluviometro = "@@@"
        if (valorPluviometro === "Soleado") {
            document.body.style.backgroundImage = 'url("https://imagizer.imageshack.com/v2/240x158q70/c/922/lODaNu.jpg")';
        } else if (valorPluviometro === "Despejado") {
            document.body.style.backgroundImage = 'url("https://imagizer.imageshack.com/v2/240x147q70/c/922/kjIOwE.jpg")';
        } else if (valorPluviometro === "Lluvioso") {
            document.body.style.backgroundImage = 'url("https://imagizer.imageshack.com/v2/240x160q70/c/924/TWpfeH.jpg")';
        } else if (valorPluviometro === "Nublado") {
            document.body.style.backgroundImage = 'url("https://imagizer.imageshack.com/v2/240x320q70/c/923/KMzLtC.jpg")';
        } else if (valorPluviometro === "Tormentoso") {
            document.body.style.backgroundImage = 'url("https://imagizer.imageshack.com/v2/240x135q70/c/922/ZXppCn.jpg")';
        } else if (valorPluviometro === "Ventoso") {
            document.body.style.backgroundImage = 'url("https://imagizer.imageshack.com/v2/240x180q70/c/924/lJLvHr.jpg")';
        } else {
            document.body.style.backgroundImage = 'url("https://imagizer.imageshack.com/v2/240x158q70/c/922/lODaNu.jpg")';
        }

        const valorVeleta = document.getElementById('valorVeleta');
        const agujaVeleta = document.getElementById('agujaVeleta');

        const marcaVeleta = (valorVeleta.textContent);

        if (marcaVeleta === "N"){
            agujaVeleta.style.transform = `rotate(0deg)`;
        } else if (marcaVeleta === "NE"){
            agujaVeleta.style.transform = `rotate(45deg)`;
        } else if (marcaVeleta === "E"){
            agujaVeleta.style.transform = `rotate(90deg)`;
        } else if (marcaVeleta === "SE"){
            agujaVeleta.style.transform = `rotate(135deg)`;
        } else if (marcaVeleta === "S"){
            agujaVeleta.style.transform = `rotate(180deg)`;
        } else if (marcaVeleta === "SO"){
            agujaVeleta.style.transform = `rotate(225deg)`;
        } else if (marcaVeleta === "O"){
            agujaVeleta.style.transform = `rotate(270deg)`;
        } else if (marcaVeleta === "NO"){
            agujaVeleta.style.transform = `rotate(315deg)`;
        }

        var myChart;

        function actualizarGrafico() {
            var hs = document.getElementById("hs").value;
            var valores;

            if (hs === "1h") {
                valores = !!VALORESHORA;
            } else if (hs === "1d") {
                valores = !!VALORESHS;
            } else if (hs === "7d") {
                valores = !!VALORES7D;
            } else if (hs === "1m") {
                valores = !!VALORES1M;
            } else if (hs === "1a") {
                valores = !!VALORES12M;
            }

            // Destruir el gráfico actual si existe
            if (myChart) {
                myChart.destroy();
            }

            // Crear el gráfico con los nuevos valores
            crearGrafico(valores);
        }

        function crearGrafico(valores) {
            myChart = new Chart(
                document.getElementById('myChart'),
                {
                    type: 'radar',
                    data: {
                        labels: ['N', 'NE', 'E', 'SE', 'S', 'SO', 'O', 'NO'],
                        datasets: [{
                            label: 'Frecuencia de aparición',
                            data: valores,
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 3
                        }]
                    },
                    options: {
                        scales: {
                            r: {
                                suggestedMin: 0
                            }
                        }
                    }
                }
            );
        }

        // Llama a la función para inicializar el gráfico
        actualizarGrafico();
    </script>
</body>
</html>
